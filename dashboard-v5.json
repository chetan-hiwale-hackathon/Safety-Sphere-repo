{"$schema":"https://pbiadx.powerbi.com/static/d/schema/54/dashboard.json","id":"3769aa5d-ca23-48da-8d1f-4bb02b6a6e2c","eTag":"\"8e77574676f14d40b362ebe444b36b9c\"","schema_version":"54","title":"v5","autoRefresh":{"enabled":true,"defaultInterval":"1s"},"tiles":[{"id":"d117ca22-32bf-4dfe-a89a-04bd2c05acd1","title":"User activity","visualType":"map","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":0,"y":0,"width":14,"height":10},"queryRef":{"kind":"query","queryId":"0d7a33e9-ef5f-4590-bacd-c35eb0eb1590"},"description":"Shows user's safe and unsafe zone","visualOptions":{"xColumn":null,"multipleYAxes":{"additional":[],"showMultiplePanels":false,"base":{"horizontalLines":[],"yAxisScale":"linear","yAxisMaximumValue":null,"yAxisMinimumValue":null,"columns":[],"label":"","id":"-1"}},"yColumns":null,"seriesColumns":null,"anomalyColumns":null,"map__sizeDisabled":false,"map__type":"bubble","map__latitudeColumn":"latitude","map__longitudeColumn":"longitude","map__labelColumn":"type","map__sizeColumn":"radius","map__geoType":"numeric","map__geoPointColumn":"zone_setup_coordinates_0"}},{"id":"2ad5b9e1-c316-4ab2-b55d-df8252e6161e","title":"Heart Rate","visualType":"card","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":14,"y":6,"width":10,"height":4},"queryRef":{"kind":"query","queryId":"b185fde3-3cea-456a-98ba-5bf2b7f74c1d"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":null,"colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"59c3f485-8740-4340-8135-0ff1d33bf0a3","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"<","column":"user_heart_rate","values":["60"]}],"chainingOperator":"and","colorStyle":"light","color":"blue","tag":"low","icon":"sad","ruleName":"Low heartrate","visualType":"card"},{"id":"75e21281-460d-4906-ac4b-931db2912758","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"values":["60"],"operator":">=","column":"user_heart_rate"},{"operator":"<=","column":"user_heart_rate","values":["110"]}],"chainingOperator":"and","colorStyle":"light","color":"green","tag":"Medium","icon":"happy","ruleName":"Medium heartrate","visualType":"card"},{"id":"b0eda30b-4e2e-4f73-87c1-d0625632f264","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":">=","column":"user_heart_rate","values":["110"]}],"chainingOperator":"and","colorStyle":"light","color":"red","tag":"High","icon":"sad","ruleName":"High heartrate","visualType":"card"}]}},{"id":"17913dec-bc80-4aca-811c-e4ea85ad183f","title":"User safety status","visualType":"card","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":14,"y":0,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"1c505abd-e533-45ae-88c4-8bf1dd5dc419"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"status","colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"f25db33d-78e9-43d8-8ecb-a6001256af36","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"type","values":["unsafe"]}],"chainingOperator":"and","colorStyle":"light","color":"red","tag":"UNSAFE","icon":"warning","ruleName":"unsafe","visualType":"card"},{"id":"8cbb6853-60fd-4460-baed-c752d6d8bc5a","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":null,"values":["safe"]}],"chainingOperator":"and","colorStyle":"bold","color":"blue","tag":"SAFE","icon":"completed","ruleName":"safe","visualType":"card"},{"id":"80987d31-bf7c-4192-acd7-518a0dbcf6c6","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"status","values":["Normal"]}],"chainingOperator":"and","colorStyle":"light","color":"yellow","tag":"Normal","icon":null,"ruleName":"Normal","visualType":"card"}]}},{"id":"a511b187-edfd-4322-b253-7b7e3f9a5936","title":"Stress","visualType":"card","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":14,"y":3,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"d8bcb3a6-0624-43d4-acf8-bffc75077711"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"stress_level","colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"49ed7afd-c378-4049-b8cc-84e2d744578f","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["Medium"]}],"chainingOperator":"or","colorStyle":"light","color":"yellow","tag":"Medium ","icon":"emojiNeutral","ruleName":"stress medium","visualType":"card"},{"id":"c22b43aa-b79e-4179-85d5-30101ae847c2","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["High"]}],"chainingOperator":"and","colorStyle":"light","color":"red","tag":"HIgh","icon":"sad","ruleName":"Stress high","visualType":"card"},{"id":"41b6f487-6535-404f-ad11-37a2c3652f17","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["Low"]}],"chainingOperator":"and","colorStyle":"light","color":"blue","tag":"Low","icon":"happy","ruleName":"stress low","visualType":"card"}]}},{"id":"e7619f8b-3fab-4bbc-945d-20b450686c91","title":"User activity","visualType":"map","pageId":"056d046d-5201-41ce-bf7a-638a742c4e47","layout":{"x":0,"y":0,"width":10,"height":4},"queryRef":{"kind":"query","queryId":"68238ec2-9c96-4784-8d03-b5cee211562e"},"visualOptions":{"map__type":"bubble","map__latitudeColumn":"latitude","map__longitudeColumn":"longitude","map__labelColumn":"type","map__sizeColumn":"radius","map__sizeDisabled":false,"map__geoType":"numeric","map__geoPointColumn":null}},{"id":"3a1afde3-56c1-4d4c-a338-b264ec7a2ebd","title":"BP Graph","visualType":"line","pageId":"6091e920-f08d-4238-819c-1ec16ecef553","layout":{"x":0,"y":0,"width":11,"height":6},"queryRef":{"kind":"query","queryId":"065ab83c-5cc7-46a2-bd9c-c7c5378fe907"},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"Blood pressure value","columns":[],"yAxisMaximumValue":160,"yAxisMinimumValue":50,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"legendLocation":"bottom","xColumnTitle":"Time","xColumn":"timeStamp","yColumns":["user_sys_blood_pressure","user_dia_blood_pressure"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"11671626-289e-49c4-9449-f4eeeafe9bd5","title":"Max BP","visualType":"card","pageId":"056d046d-5201-41ce-bf7a-638a742c4e47","layout":{"x":0,"y":4,"width":6,"height":3},"queryRef":{"kind":"query","queryId":"73bb8bb0-3178-41b6-8c4b-f0dada20099e"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"max_user_blood_pressure","colorRulesDisabled":true,"colorStyle":"light","colorRules":[]}},{"id":"1be91078-4c9e-48d8-b3dd-43d9e69ace1f","title":"Min BP","visualType":"card","pageId":"056d046d-5201-41ce-bf7a-638a742c4e47","layout":{"x":0,"y":7,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"5c351f00-9f39-4d8a-b543-598d01d84b4b"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"min_user_blood_pressure","colorRulesDisabled":true,"colorStyle":"light","colorRules":[]}},{"id":"c53b9ef7-a891-4ef7-a9cd-8c509c8a040a","title":"Live tracking","visualType":"map","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":0,"y":10,"width":24,"height":7},"queryRef":{"kind":"query","queryId":"9319ef28-272b-4561-8799-acb7458dd164"},"visualOptions":{"map__type":"bubble","map__latitudeColumn":"user_latitude","map__longitudeColumn":"user_longitude","map__labelColumn":null,"map__sizeColumn":null,"map__sizeDisabled":true,"map__geoType":"numeric","map__geoPointColumn":null}},{"id":"4d77b3c3-01d3-4f36-9085-c257182dc7d2","title":"Heart Rate Graph","visualType":"line","pageId":"6091e920-f08d-4238-819c-1ec16ecef553","layout":{"x":11,"y":0,"width":11,"height":6},"queryRef":{"kind":"query","queryId":"4a7e92d9-734c-4400-b742-a1c4c2d81a09"},"visualOptions":{"multipleYAxes":{"base":{"id":"-1","label":"","columns":[],"yAxisMaximumValue":null,"yAxisMinimumValue":null,"yAxisScale":"linear","horizontalLines":[]},"additional":[],"showMultiplePanels":false},"hideLegend":false,"legendLocation":"bottom","xColumnTitle":"","xColumn":"timeStamp","yColumns":["user_heart_rate"],"seriesColumns":null,"xAxisScale":"linear","verticalLine":"","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[]}},{"id":"6025a2c6-ed54-404b-9476-f33c38d58aca","title":"Max HeartRate","visualType":"card","pageId":"6091e920-f08d-4238-819c-1ec16ecef553","layout":{"x":0,"y":6,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"ef24e0e1-0f77-4b57-bb3d-79b0f86287e9"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"max_user_heart_rate","colorRulesDisabled":true,"colorStyle":"light","colorRules":[]}},{"id":"38b23264-744d-43e9-946b-b71571882904","title":"Min HeartRate","visualType":"card","pageId":"6091e920-f08d-4238-819c-1ec16ecef553","layout":{"x":5,"y":6,"width":6,"height":3},"queryRef":{"kind":"query","queryId":"75b58c85-7a68-4205-bac9-85b6ad25c163"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"min_user_heart_rate","colorRulesDisabled":true,"colorStyle":"light","colorRules":[]}},{"id":"cc4860d1-2ffd-4d30-b253-b7eee88a1202","title":"Stress level","visualType":"card","pageId":"6091e920-f08d-4238-819c-1ec16ecef553","layout":{"x":11,"y":6,"width":11,"height":3},"queryRef":{"kind":"query","queryId":"7a47f84a-1f05-4a7f-9212-f15b19292710"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"stress_level","colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"96e73035-aac7-45ef-ac31-55eb76482405","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["Low"]}],"chainingOperator":"and","colorStyle":"light","color":"green","tag":"Low Stress","icon":"happy","ruleName":"Low stress","visualType":"card"},{"id":"530243e9-57a3-4f9c-9d69-b832be9a733e","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["Medium"]}],"chainingOperator":"and","colorStyle":"light","color":"yellow","tag":"Medium Stress","icon":"emojiNeutral","ruleName":"Medium Stress","visualType":"card"},{"id":"5fbc03ba-df3f-45f4-92b9-54771a16245b","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"stress_level","values":["High"]}],"chainingOperator":"and","colorStyle":"bold","color":"red","tag":"High Stress","icon":"sad","ruleName":"High stress","visualType":"card"}]}},{"id":"7bdf6da5-7b59-491e-831d-7d604acbbd11","title":"New tile","visualType":"table","pageId":"056d046d-5201-41ce-bf7a-638a742c4e47","layout":{"x":10,"y":0,"width":9,"height":7},"queryRef":{"kind":"query","queryId":"b3802718-66b2-4feb-ad98-a3cc8f87c01b"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}},{"id":"cdcae433-eb3c-494e-b749-f18eb7d8361f","title":"Nearest Family Member","visualType":"card","pageId":"056d046d-5201-41ce-bf7a-638a742c4e47","layout":{"x":19,"y":0,"width":5,"height":4},"queryRef":{"kind":"query","queryId":"4b2fdb69-0dfc-4167-900a-02e2b60ae65c"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"user_id","colorRulesDisabled":false,"colorStyle":"light","colorRules":[]}},{"id":"1c834452-17c9-49b9-8cca-17b0a4e72fd6","title":"Blood pressure","visualType":"card","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":19,"y":3,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"396a3040-bdff-4219-83d9-4a16513c5ab5"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":null,"colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"59c3f485-8740-4340-8135-0ff1d33bf0a3","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"<","column":"user_blood_pressure","values":["60"]}],"chainingOperator":"and","colorStyle":"light","color":"blue","tag":"low","icon":"sad","ruleName":"Low pressure","visualType":"card"},{"id":"75e21281-460d-4906-ac4b-931db2912758","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":">=","column":"user_blood_pressure","values":["60"]},{"operator":"<=","column":"user_blood_pressure","values":["110"]}],"chainingOperator":"and","colorStyle":"light","color":"green","tag":"Medium","icon":"happy","ruleName":"Medium bloodpressure","visualType":"card"},{"id":"b0eda30b-4e2e-4f73-87c1-d0625632f264","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":">=","column":"user_blood_pressure","values":["110"]}],"chainingOperator":"and","colorStyle":"light","color":"red","tag":"High","icon":"sad","ruleName":"High bloodpressure","visualType":"card"}]}},{"id":"250523a2-3f70-4e0e-963c-c73b3c0d6247","title":"Panic state","visualType":"card","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":19,"y":0,"width":5,"height":3},"queryRef":{"kind":"query","queryId":"6219d74a-fa4f-46a6-b605-134ef50bea38"},"visualOptions":{"multiStat__textSize":"auto","multiStat__valueColumn":"status","colorRulesDisabled":false,"colorStyle":"light","colorRules":[{"id":"9313d8a8-4ee3-4ee5-a31f-069eff37e905","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"operator":"==","column":"status","values":["PANIC"]}],"chainingOperator":"and","colorStyle":"bold","color":"red","tag":"PANIC","icon":"warning","ruleName":"panic_status","visualType":"card"},{"id":"5b2bb975-578c-4b3d-aaae-b40f0d8edfdc","ruleType":"colorByCondition","applyToColumn":null,"hideText":false,"applyTo":"cells","conditions":[{"values":["NORMAL"],"operator":"==","column":"status"}],"chainingOperator":"and","colorStyle":"bold","color":"green","tag":"NORMAL","icon":"insights","ruleName":"normal","visualType":"card"}]}},{"id":"3d015ea3-444e-41bc-b456-45bb81855a5c","title":"Alerts logs","visualType":"table","pageId":"180ea482-ee92-4da4-818e-ed0dfae640e1","layout":{"x":0,"y":17,"width":24,"height":4},"queryRef":{"kind":"query","queryId":"0c2c6ee5-185f-40a4-acf9-e12e7f182346"},"visualOptions":{"table__enableRenderLinks":true,"colorRulesDisabled":true,"colorStyle":"light","crossFilterDisabled":false,"drillthroughDisabled":false,"crossFilter":[],"drillthrough":[],"table__renderLinks":[],"colorRules":[]}}],"baseQueries":[{"id":"83b56485-bc34-4afa-97ba-feca58de74ee","queryId":"00ae97c7-6b08-4ab5-ba5f-ca0e84c2528f","variableName":"zone_setup"},{"id":"f0230db5-af4c-4b6e-9d3d-5410a60c0766","queryId":"090a43da-e9f5-4152-a217-59aa2fadbd58","variableName":"safe_zone_per_family"},{"id":"d7be8827-20b5-4ba9-8289-83781212a06b","queryId":"e3963680-d3ef-423a-ad2e-646471cdc6cf","variableName":"latest_user_location"},{"id":"217a6c11-3d54-4016-823c-dd7c86bcc5e0","queryId":"40019fcd-0b67-4775-86f8-59881c6cc766","variableName":"safe_zone_distance"},{"id":"5626292d-dd1f-46e4-acb3-28879727d904","queryId":"1c920123-177c-458b-8775-e6ecb83b54fa","variableName":"closest_unsafe_point"},{"id":"3484a71b-b3d9-4c7a-96c5-fd8568fb5651","queryId":"90cad50e-4ce1-4e4c-acda-5ff210808241","variableName":"nearest_unsafe_cluster_centroid"},{"id":"98d2000d-9796-433d-8087-43b6fc8b5ea6","queryId":"eea162dc-3bd5-4439-99e4-ce0021a0428e","variableName":"per_min_health"},{"id":"84bba0df-a22f-47dc-9bd8-c8b18e0d2528","queryId":"1a1289f7-6a5f-4a6b-a733-95728851684c","variableName":"last_one_day_heath"},{"id":"0641a99e-da45-43bc-9bcb-c67f1032e930","queryId":"3847e239-a89e-4796-a460-7e575b2f85c7","variableName":"check_user_status"},{"id":"72ca8916-4f66-4e83-89fe-3a496ba7ae78","queryId":"d4b05c5d-f2bc-4e65-9ff8-1b6c9721497f","variableName":"selected_user_id"}],"parameters":[{"kind":"duration","id":"e1131e58-034d-4df4-a065-cf5ff17542d3","displayName":"Time range","description":"","beginVariableName":"_startTime","endVariableName":"_endTime","defaultValue":{"kind":"dynamic","count":1,"unit":"hours"},"showOnPages":{"kind":"all"}},{"kind":"string","id":"17ef6734-73e9-4dbd-ad9a-6629a0af8f1b","displayName":"user name","description":"","variableName":"selected_user_name","selectionType":"scalar","includeAllOption":false,"defaultValue":{"kind":"value","value":"abhinav"},"dataSource":{"kind":"query","columns":{"value":"name"},"queryRef":{"kind":"query","queryId":"aeab8a05-b03a-4653-99c3-72dae44d37fc"}},"showOnPages":{"kind":"all"}},{"kind":"int","id":"674fbd0e-e401-4641-9d94-b8857444d672","displayName":"family id","description":"","variableName":"selected_family_id","selectionType":"scalar","includeAllOption":false,"defaultValue":{"kind":"value","value":1},"dataSource":{"kind":"query","columns":{"value":"family_id"},"queryRef":{"kind":"query","queryId":"760b5ab9-b0c8-4b87-b36b-189a04a08443"}},"showOnPages":{"kind":"all"}}],"dataSources":[{"id":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0","kind":"kusto-trident","scopeId":"kusto-trident","clusterUri":"https://trd-mwdyc69szk2uga2n12.z0.kusto.fabric.microsoft.com","database":"10fb7127-4824-4c45-a58b-a62e4cc3e10f","name":"KQL_DB","workspace":"8da952e4-df0c-417d-9265-5b09308bb541"}],"pages":[{"name":"USER VIEW","id":"180ea482-ee92-4da4-818e-ed0dfae640e1"},{"name":"USER HEALTH VIEW","id":"6091e920-f08d-4238-819c-1ec16ecef553"},{"name":"Temp Page","id":"056d046d-5201-41ce-bf7a-638a742c4e47"}],"queries":[{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"let user_name = user | where user_id  == toint(toscalar(selected_user_id | project user_id)) | project user_name;\r\nlet zones = nearest_unsafe_cluster_centroid\r\n| union safe_zone_per_family\r\n| project \r\n    latitude = iff(isnull(avg_lat), toreal(zone_latitude), toreal(avg_lat)),\r\n    longitude = iff(isnull(avg_long), toreal(zone_longitude), toreal(avg_long)),\r\n    radius = iff(isnull(zone_radius_real), toreal(zone_radius_int), toreal(zone_radius_real)),\r\n    type = zone_type,\r\n    title= zone_title\r\n;\r\nzones \r\n| union latest_user_location\r\n| project \r\n    latitude = iff(isnull(latitude), toreal(user_latitude), toreal(latitude)),\r\n    longitude = iff(isnull(longitude), toreal(user_longitude), toreal(longitude)),\r\n    radius = iff(isnull(radius), toreal(50), toreal(radius)),\r\n    type = iff(isnull(type), tostring(toscalar(user_name | project user_name)), type)\r\n;\r\n\r\n","id":"0d7a33e9-ef5f-4590-bacd-c35eb0eb1590","usedVariables":["latest_user_location","nearest_unsafe_cluster_centroid","safe_zone_per_family","selected_user_id"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"latest_user_location\n| project user_heart_rate","id":"b185fde3-3cea-456a-98ba-5bf2b7f74c1d","usedVariables":["latest_user_location"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"let status = check_user_status \r\n| where geo_point_in_circle(lat, longi, latitude, longitude, 50)\r\n| project type;\r\nlet countStatus = status | summarize c = count();\r\ncountStatus\r\n| project status = iff(c > 0, toscalar(status | project type), \"Normal\");\r\n","id":"1c505abd-e533-45ae-88c4-8bf1dd5dc419","usedVariables":["check_user_status"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"latest_user_location \n| project \n    stress_level = iff(toreal(user_stress) > 20, \"High\",\n         iff(toreal(user_stress) > 10, \"Medium\", \"Low stress\"))\n","id":"d8bcb3a6-0624-43d4-acf8-bffc75077711","usedVariables":["latest_user_location"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"let user_name = user | where user_id  == selected_user_id | project user_name;\nlet zones = nearest_unsafe_cluster_centroid\n| union safe_zone_per_family\n| project \n    latitude = iff(isnull(avg_lat), toreal(zone_latitude), toreal(avg_lat)),\n    longitude = iff(isnull(avg_long), toreal(zone_longitude), toreal(avg_long)),\n    radius = iff(isnull(zone_radius_real), toreal(zone_radius_int), toreal(zone_radius_real)),\n    type = zone_type,\n    title= zone_title\n;\nzones \n| union latest_user_location\n| project \n    latitude = iff(isnull(latitude), toreal(user_latitude), toreal(latitude)),\n    longitude = iff(isnull(longitude), toreal(user_longitude), toreal(longitude)),\n    radius = iff(isnull(radius), toreal(10), toreal(radius)),\n    type = iff(isnull(type), tostring(toscalar(user_name | project user_name)), type)\n;","id":"68238ec2-9c96-4784-8d03-b5cee211562e","usedVariables":["latest_user_location","nearest_unsafe_cluster_centroid","safe_zone_per_family","selected_user_id"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"per_min_health \n| project toint(user_sys_blood_pressure), toint(user_dia_blood_pressure),todatetime(timeStamp)","id":"065ab83c-5cc7-46a2-bd9c-c7c5378fe907","usedVariables":["per_min_health"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// sakshi\r\nlast_one_day_heath\r\n| summarize dio = max(toint(user_dia_blood_pressure)), sys = max(toint(user_sys_blood_pressure))\r\n| project  dio, sys","id":"73bb8bb0-3178-41b6-8c4b-f0dada20099e","usedVariables":["last_one_day_heath"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// sakshi\r\nlast_one_day_heath\r\n| summarize min(user_blood_pressure)","id":"5c351f00-9f39-4d8a-b543-598d01d84b4b","usedVariables":["last_one_day_heath"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"\n// // start_livestreaming_location\n// // | project user_latitude, user_longitude;\n\nlet user_id = panic_logs | where user_id == toint(toscalar(selected_user_id | project user_id)) | sort by timeStamp desc | top 1 by timeStamp | project user_id;\nlet session_id = panic_logs | where user_id == toint(toscalar(selected_user_id | project user_id)) | sort by timeStamp desc | top 1 by timeStamp | project session_id;\nlive_streaming\n| where user_id == toint(toscalar(selected_user_id | project user_id)) and panic_session_id  == toint(toscalar(session_id))\n| project user_latitude, user_longitude;\n\npanic_logs","id":"9319ef28-272b-4561-8799-acb7458dd164","usedVariables":["selected_user_id"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"per_min_health\n| project user_heart_rate,todatetime(timeStamp)","id":"4a7e92d9-734c-4400-b742-a1c4c2d81a09","usedVariables":["per_min_health"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// sakshi\r\nlast_one_day_heath\r\n| summarize max(user_heart_rate)","id":"ef24e0e1-0f77-4b57-bb3d-79b0f86287e9","usedVariables":["last_one_day_heath"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// sakshi\r\nlast_one_day_heath\r\n| summarize min(user_heart_rate)","id":"75b58c85-7a68-4205-bac9-85b6ad25c163","usedVariables":["last_one_day_heath"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"per_min_health\n| sort by timeStamp desc \n| top 1 by timeStamp\n| project stress_level = iff(toreal(user_stress) < 10, \"Low\", iff(toreal(user_stress) > 20, \"High\", \"Medium\"));\n","id":"7a47f84a-1f05-4a7f-9212-f15b19292710","usedVariables":["per_min_health"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"per_min_health\n| sort by timeStamp desc\n| top 1 by timeStamp\n| extend stress_level = iff(toreal(user_stress) < 10, \"Low\", iff(toreal(user_stress) > 20, \"High\", \"Medium\"))\n| project stress_level;","id":"b3802718-66b2-4feb-ad98-a3cc8f87c01b","usedVariables":["per_min_health"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"bi","id":"4b2fdb69-0dfc-4167-900a-02e2b60ae65c","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"latest_user_location\n| project strcat(toint(user_sys_blood_pressure), \"/\" , toint(user_dia_blood_pressure) )","id":"396a3040-bdff-4219-83d9-4a16513c5ab5","usedVariables":["latest_user_location"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// panic_logs\n// | join kind=inner input on $left.user_id == $right.user_id\n// | where \n//     user_id == selected_user_id and user_is_panic == 1\ninput\n| sort by timeStamp desc\n| top 1 by timeStamp\n| extend status = iff(user_is_panic == 1, \"PANIC\", \"NORMAL\");","id":"6219d74a-fa4f-46a6-b605-134ef50bea38","usedVariables":[]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"alerts_logs \r\n| where user_id == toint(toscalar(selected_user_id | project user_id)) \r\n| sort by alert_send_at desc\r\n|  project alert_send_at, alert_message","id":"0c2c6ee5-185f-40a4-acf9-e12e7f182346","usedVariables":["selected_user_id"]},{"id":"00ae97c7-6b08-4ab5-ba5f-ca0e84c2528f","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"input\n| join kind=inner user on $left.user_id == $right.user_id\n| project user_latitude, user_longitude, user_family_id, timeStamp\n| join kind=inner family on $left.user_family_id == $right.family_id\n| join kind=inner zone on $left.family_safe_zone_id == $right.zone_id\n| project zone_latitude, zone_longitude, zone_radius, zone_title, zone_type, zone_unsafe_score, user_latitude, user_longitude, timeStamp\n// | where geo_point_in_circle(toreal(user_latitude), toreal(user_longitude), toreal(zone_latitude), toreal(zone_longitude), toreal(zone_radius))\n// | render plotly with (kind=map)","usedVariables":[]},{"id":"090a43da-e9f5-4152-a217-59aa2fadbd58","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"family\n| join zone on $left.family_safe_zone_id == $right.zone_id\n| where family_id == selected_family_id and zone_type == \"safe\"\n| project\n    zone_latitude, zone_longitude, zone_radius, zone_title, zone_type","usedVariables":["selected_family_id"]},{"id":"e3963680-d3ef-423a-ad2e-646471cdc6cf","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"input\n| where user_id == toint(toscalar(selected_user_id | project user_id))\n| sort by timeStamp desc\n| top 1 by timeStamp\n| project \n    user_latitude, user_longitude, user_is_panic, user_heart_rate, user_stress, user_dia_blood_pressure, user_sys_blood_pressure, selected_family_id;","usedVariables":["selected_family_id","selected_user_id"]},{"id":"40019fcd-0b67-4775-86f8-59881c6cc766","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"let lat_long = latest_user_location | project user_latitude, user_longitude;\nsafe_zone_per_family \n| extend user_latitude = toscalar(lat_long | project user_latitude), user_longitude = toscalar(lat_long | project user_longitude)\n| project distance = geo_distance_2points(toreal(user_latitude), toreal(user_longitude), zone_latitude, zone_longitude), zone_latitude, zone_longitude\n| summarize min_distance = min(distance) by distance\n| order by min_distance asc\n| top 1 by min_distance","usedVariables":["latest_user_location","safe_zone_per_family"]},{"id":"1c920123-177c-458b-8775-e6ecb83b54fa","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// calculates nearest unsafe zone point to the user location\nzone \n| where \n    distance = geo_distance_2points( \n        toreal(toscalar(latest_user_location | project user_latitude)),\n        toreal(toscalar(latest_user_location | project user_longitude)),\n        zone_latitude,\n        zone_longitude\n        ) < 1000\n    and zone_type == \"unsafe\"","usedVariables":["latest_user_location"]},{"id":"90cad50e-4ce1-4e4c-acda-5ff210808241","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"zone \n| where \n    zone_type == \"unsafe\" \n        and \n    geo_distance_2points(\n        toreal(toscalar(closest_unsafe_point | project zone_latitude)), \n        toreal(toscalar(closest_unsafe_point | project zone_longitude)), \n        zone_latitude,\n        zone_longitude\n    ) < 10\n| summarize \n    avg_lat = avg(zone_latitude),\n    avg_long = avg(zone_longitude)\n| project \n    avg_lat,\n    avg_long,\n    zone_type = \"unsafe\",\n    zone_radius = toreal(500)","usedVariables":["closest_unsafe_point"]},{"id":"eea162dc-3bd5-4439-99e4-ce0021a0428e","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// Please enter your KQL query (Example):\n// <table name>\n// | where <datetime column> between (['_startTime'] .. ['_endTime']) // Time range filtering\n// | where isempty(['selected_family_id']) or <column name> == ['selected_family_id'] // Single selection filtering\n// | where isempty(['selected_user_id']) or <column name> == ['selected_user_id'] // Single selection filtering\n// | take 100\n\ninput\n| where todatetime(timeStamp) > now(-1m)\n| project user_dia_blood_pressure, user_sys_blood_pressure,user_heart_rate,user_stress,timeStamp","usedVariables":[]},{"id":"1a1289f7-6a5f-4a6b-a733-95728851684c","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"// Please enter your KQL query (Example):\n// <table name>\n// | where <datetime column> between (['_startTime'] .. ['_endTime']) // Time range filtering\n// | where isempty(['selected_family_id']) or <column name> == ['selected_family_id'] // Single selection filtering\n// | where isempty(['selected_user_id']) or <column name> == ['selected_user_id'] // Single selection filtering\n// | take 100\n\n\ninput\n| where todatetime( timeStamp) > now(-1d)\n| project user_dia_blood_pressure, user_sys_blood_pressure,user_heart_rate,user_stress","usedVariables":[]},{"id":"3847e239-a89e-4796-a460-7e575b2f85c7","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"let lat = toreal(toscalar (latest_user_location | project user_latitude));\nlet longi = toreal(toscalar (latest_user_location | project user_longitude));\nlet user_name = user | where user_id  == toint(toscalar(selected_user_id | project user_id)) | project user_name;\nnearest_unsafe_cluster_centroid\n| union safe_zone_per_family\n| project \n    lat, \n    longi,\n    latitude = iff(isnull(avg_lat), toreal(zone_latitude), toreal(avg_lat)),\n    longitude = iff(isnull(avg_long), toreal(zone_longitude), toreal(avg_long)),\n    radius = iff(isnull(zone_radius_real), toreal(50), toreal(50)),\n    type = zone_type,\n    title= zone_title\n;","usedVariables":["latest_user_location","nearest_unsafe_cluster_centroid","safe_zone_per_family","selected_user_id"]},{"id":"d4b05c5d-f2bc-4e65-9ff8-1b6c9721497f","dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"user \n| where user_family_id == selected_family_id and user_name == selected_user_name\n| project user_id","usedVariables":["selected_family_id","selected_user_name"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"user\n| where user_family_id  == selected_family_id\n| project name =  user_name","id":"aeab8a05-b03a-4653-99c3-72dae44d37fc","usedVariables":["selected_family_id"]},{"dataSource":{"kind":"inline","dataSourceId":"cc4f19ea-89a3-457b-bcca-116da2e4e9e0"},"text":"family | summarize by family_id;\n","id":"760b5ab9-b0c8-4b87-b36b-189a04a08443","usedVariables":[]}]}